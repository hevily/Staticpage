<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta name="format-detection" content="telephone=no" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
    <!-- <link rel="stylesheet" type="text/css" href="/statichtml/moviehelper/app/Public/base.css" /> -->
    <!-- <link rel="stylesheet" type="text/css" href="../css/" /> -->
	<title>shake</title>
</head>
<body onload="init()">
	<header></header>
	<div class="container">
		<div class="section">
			<p>用力摇一摇你手机</p>  
<audio style="display:hiden" id="musicBox" preload="metadata" controls src="http://211.148.5.228:8002/Pages/test/Kalimba.mp3" autoplay="false">  
		</div>
		<div class="section">

		</div>
	</div>
	<footer></footer>

	<!-- <script src="/statichtml/moviehelper/app/Public/jQuery/jquery-2.1.4.min.js"></script> -->
	<script type="text/javascript">
		var SHAKE_THRESHOLD = 3000;  
		        var last_update = 0;  
		        var x = y = z = last_x = last_y = last_z = 0;  
		        function init() {  
		            if (window.DeviceMotionEvent) {  
		                window.addEventListener('devicemotion', deviceMotionHandler, false);  
		            } else {  
		                alert('not support mobile event');  
		            }  
		        }  
		        function deviceMotionHandler(eventData) {  
		            var acceleration = eventData.accelerationIncludingGravity;  
		            var curTime = new Date().getTime();  
		            if ((curTime - last_update) > 100) {  
		                var diffTime = curTime - last_update;  
		                last_update = curTime;  
		                x = acceleration.x;  
		                y = acceleration.y;  
		                z = acceleration.z;  
		                var speed = Math.abs(x + y + z - last_x - last_y - last_z) / diffTime * 10000;  
		  
		                if (speed > SHAKE_THRESHOLD) {  
		                    alert("摇动了");  
		                    media.setAttribute("src", "http://211.148.5.228:8002/Pages/test/Kalimba.mp3");  
		                    media.load();  
		                    media.play();    
		                }  
		                last_x = x;  
		                last_y = y;  
		                last_z = z;  
		            }  
		        }  
	</script>
</body>
</html>